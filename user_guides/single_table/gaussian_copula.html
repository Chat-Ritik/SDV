
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>GaussianCopula Model &#8212; SDV 0.12.1 documentation</title>
    
  <link rel="stylesheet" href="../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sdv.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../../_static/SDV-Logo-Black.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="CTGAN Model" href="ctgan.html" />
    <link rel="prev" title="Models" href="models.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

    <a class="navbar-brand" href="../../index.html">
    
      <img src="../../_static/SDV-Logo-Color.png" class="logo" alt="logo" />
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../../getting_started/index.html">Getting Started</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="../index.html">User Guides</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../api_reference/index.html">API Reference</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../developer_guides/index.html">Developer Guides</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../history.html">Release Notes</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/sdv-dev/SDV" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
          <li class="nav-item">
            <a class="nav-link" href="https://twitter.com/sdv_dev" target="_blank" rel="noopener">
              <span><i class="fab fa-twitter-square"></i></span>
            </a>
          </li>
        
        
          <li class="nav-item">
            <a class="nav-link" href="https://join.slack.com/t/sdv-space/shared_invite/zt-gdsfcb5w-0QQpFMVoyB2Yd6SRiMplcw" target="_blank" rel="noopener">
              <img class="nav-icon-img" src="../../_static/slack-32.png">
            </a>
          </li>
        
      </ul>
    </div>
</div>

    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
    
    <ul class="nav bd-sidenav">
        
        
        
        
          
            
                <li class="active">
                    <a href="index.html">Single Table Data</a>
                    <ul>
                    
                        
                            <li class="">
                                <a href="data_description.html">Data Description</a>
                            </li>
                        

                    
                        
                            <li class="active">
                                <a href="models.html">Models</a>
                                <ul>
                                
                                    <li class="active">
                                        <a href="">GaussianCopula Model</a>
                                    </li>
                                
                                    <li class="">
                                        <a href="ctgan.html">CTGAN Model</a>
                                    </li>
                                
                                    <li class="">
                                        <a href="copulagan.html">CopulaGAN Model</a>
                                    </li>
                                
                                    <li class="">
                                        <a href="tvae.html">TVAE Model</a>
                                    </li>
                                
                                </ul>
                            </li>
                        

                    
                        
                            <li class="">
                                <a href="constraints.html">Constraints</a>
                            </li>
                        

                    
                    </ul>
                </li>
            
          
            
                <li class="">
                    <a href="../relational/index.html">Relational Data</a>
                </li>
            
          
            
                <li class="">
                    <a href="../timeseries/index.html">Timeseries Data</a>
                </li>
            
          
            
                <li class="">
                    <a href="../evaluation/index.html">Synthetic Data Evaluation</a>
                </li>
            
          
            
                <li class="">
                    <a href="../benchmarking/index.html">Benchmarking Framework</a>
                </li>
            
          
        
        
        
        
        
        
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#what-is-gaussiancopula" class="nav-link">What is GaussianCopula?</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#quick-usage" class="nav-link">Quick Usage</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#generate-synthetic-data-from-the-model" class="nav-link">Generate synthetic data from the model</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#save-and-load-the-model" class="nav-link">Save and Load the model</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#save-and-share-the-model" class="nav-link">Save and share the model</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#load-the-model-and-generate-new-data" class="nav-link">Load the model and generate new data</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#specifying-the-primary-key-of-the-table" class="nav-link">Specifying the Primary Key of the table</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#anonymizing-personally-identifiable-information-pii" class="nav-link">Anonymizing Personally Identifiable Information (PII)</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#advanced-usage" class="nav-link">Advanced Usage</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#how-to-set-transforms-to-use" class="nav-link">How to set transforms to use?</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#setting-bounds-and-specifying-rounding-for-numerical-columns" class="nav-link">Setting Bounds and Specifying Rounding for Numerical Columns</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#exploring-the-probability-distributions" class="nav-link">Exploring the Probability Distributions</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#setting-distributions-for-individual-variables" class="nav-link">Setting distributions for individual variables</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#conditional-sampling" class="nav-link">Conditional Sampling</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#how-do-i-specify-constraints" class="nav-link">How do I specify constraints?</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#can-i-evaluate-the-synthetic-data" class="nav-link">Can I evaluate the Synthetic Data?</a>
        </li>
    
            </ul>
        </li>
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="gaussiancopula-model">
<span id="gaussian-copula"></span><h1>GaussianCopula Model<a class="headerlink" href="#gaussiancopula-model" title="Permalink to this headline">¶</a></h1>
<p>In this guide we will go through a series of steps that will let you
discover functionalities of the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> model, including how
to:</p>
<ul class="simple">
<li><p>Create an instance of a <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code>.</p></li>
<li><p>Fit the instance to your data.</p></li>
<li><p>Generate synthetic versions of your data.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> to anonymize PII information.</p></li>
<li><p>Customize the data transformations to improve the learning process.</p></li>
<li><p>Specify the column distributions to improve the output quality.</p></li>
</ul>
<section id="what-is-gaussiancopula">
<h2>What is GaussianCopula?<a class="headerlink" href="#what-is-gaussiancopula" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">sdv.tabular.GaussianCopula</span></code> model is based on
<a class="reference external" href="https://en.wikipedia.org/wiki/Copula_%28probability_theory%29">copula funtions</a>.</p>
<p>In mathematical terms, a <em>copula</em> is a distribution over the unit
cube <span class="math notranslate nohighlight">\({\displaystyle [0,1]^{d}}\)</span> which is constructed from a
multivariate normal distribution over
<span class="math notranslate nohighlight">\({\displaystyle \mathbb {R} ^{d}}\)</span> by using the probability
integral transform. Intuitively, a <em>copula</em> is a mathematical function
that allows us to describe the joint distribution of multiple random
variables by analyzing the dependencies between their marginal
distributions.</p>
<p>Let’s now discover how to learn a dataset and later on generate
synthetic data with the same format and statistical properties by using
the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> model.</p>
</section>
<section id="quick-usage">
<h2>Quick Usage<a class="headerlink" href="#quick-usage" title="Permalink to this headline">¶</a></h2>
<p>We will start by loading one of our demo datasets, the
<code class="docutils literal notranslate"><span class="pre">student_placements</span></code>, which contains information about MBA students
that applied for placements during the year 2020.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">sdv.demo</span> <span class="kn">import</span> <span class="n">load_tabular_demo</span>

<span class="gp">In [2]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">load_tabular_demo</span><span class="p">(</span><span class="s1">&#39;student_placements&#39;</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[3]: </span><span class="go"></span>
<span class="go">   student_id gender  second_perc  high_perc high_spec  degree_perc degree_type  work_experience  experience_years  employability_perc mba_spec  mba_perc   salary  placed start_date   end_date  duration</span>
<span class="go">0       17264      M        67.00      91.00  Commerce        58.00    Sci&amp;Tech            False                 0                55.0   Mkt&amp;HR     58.80  27000.0    True 2020-07-23 2020-10-12       3.0</span>
<span class="go">1       17265      M        79.33      78.33   Science        77.48    Sci&amp;Tech             True                 1                86.5  Mkt&amp;Fin     66.28  20000.0    True 2020-01-11 2020-04-09       3.0</span>
<span class="go">2       17266      M        65.00      68.00      Arts        64.00   Comm&amp;Mgmt            False                 0                75.0  Mkt&amp;Fin     57.80  25000.0    True 2020-01-26 2020-07-13       6.0</span>
<span class="go">3       17267      M        56.00      52.00   Science        52.00    Sci&amp;Tech            False                 0                66.0   Mkt&amp;HR     59.43      NaN   False        NaT        NaT       NaN</span>
<span class="go">4       17268      M        85.80      73.60  Commerce        73.30   Comm&amp;Mgmt            False                 0                96.8  Mkt&amp;Fin     55.50  42500.0    True 2020-07-04 2020-09-27       3.0</span>
</pre></div>
</div>
<p>As you can see, this table contains information about students which
includes, among other things:</p>
<ul class="simple">
<li><p>Their id and gender</p></li>
<li><p>Their grades and specializations</p></li>
<li><p>Their work experience</p></li>
<li><p>The salary that they were offered</p></li>
<li><p>The duration and dates of their placement</p></li>
</ul>
<p>You will notice that there is data with the following characteristics:</p>
<ul class="simple">
<li><p>There are float, integer, boolean, categorical and datetime values.</p></li>
<li><p>There are some variables that have missing data. In particular, all
the data related to the placement details is missing in the rows
where the student was not placed.</p></li>
</ul>
<p>Let us use the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> to learn this data and then sample
synthetic data about new students to see how well the model captures the
characteristics indicated above. In order to do this you will need to:</p>
<ul class="simple">
<li><p>Import the <code class="docutils literal notranslate"><span class="pre">sdv.tabular.GaussianCopula</span></code> class and create an
instance of it.</p></li>
<li><p>Call its <code class="docutils literal notranslate"><span class="pre">fit</span></code> method passing our table.</p></li>
<li><p>Call its <code class="docutils literal notranslate"><span class="pre">sample</span></code> method indicating the number of synthetic rows
that you want to generate.</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [4]: </span><span class="kn">from</span> <span class="nn">sdv.tabular</span> <span class="kn">import</span> <span class="n">GaussianCopula</span>

<span class="gp">In [5]: </span><span class="n">model</span> <span class="o">=</span> <span class="n">GaussianCopula</span><span class="p">()</span>

<span class="gp">In [6]: </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Notice that the model <code class="docutils literal notranslate"><span class="pre">fitting</span></code> process took care of transforming the
different fields using the appropriate <a class="reference external" href="http://github.com/sdv-dev/RDT">Reversible Data
Transforms</a> to ensure that the data
has a format that the <code class="docutils literal notranslate"><span class="pre">GaussianMultivariate</span></code> model can handle.</p>
</div>
<section id="generate-synthetic-data-from-the-model">
<h3>Generate synthetic data from the model<a class="headerlink" href="#generate-synthetic-data-from-the-model" title="Permalink to this headline">¶</a></h3>
<p>Once the modeling has finished you are ready to generate new synthetic
data by calling the <code class="docutils literal notranslate"><span class="pre">sample</span></code> method from your model passing the number
of rows that we want to generate.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="n">new_data</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
<p>This will return a table identical to the one which the model was fitted
on, but filled with new data which resembles the original one.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="n">new_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[8]: </span><span class="go"></span>
<span class="go">   student_id gender  second_perc  high_perc high_spec  degree_perc degree_type  work_experience  experience_years  employability_perc mba_spec  mba_perc   salary  placed start_date   end_date  duration</span>
<span class="go">0       17434      F        68.97      74.33  Commerce        54.33   Comm&amp;Mgmt            False                 0               76.69   Mkt&amp;HR     60.98      NaN   False        NaT        NaT       NaN</span>
<span class="go">1       17432      M        71.63      73.38   Science        71.79    Sci&amp;Tech            False                 0               89.43  Mkt&amp;Fin     66.05  31800.0    True 2020-01-18 2020-08-09       6.0</span>
<span class="go">2       17291      M        73.39      72.20  Commerce        71.05   Comm&amp;Mgmt            False                 0               63.68  Mkt&amp;Fin     62.16  25900.0    True 2020-02-19 2020-09-16       6.0</span>
<span class="go">3       17455      M        69.89      38.66   Science        72.88    Sci&amp;Tech            False                 1               79.93   Mkt&amp;HR     67.93  25000.0    True 2020-04-26 2020-07-11       3.0</span>
<span class="go">4       17382      F        82.36      61.30   Science        79.62    Sci&amp;Tech            False                 0               67.62   Mkt&amp;HR     60.62  24800.0    True 2020-09-21 2021-01-04       5.0</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can control the number of rows by specifying the number of
<code class="docutils literal notranslate"><span class="pre">samples</span></code> in the <code class="docutils literal notranslate"><span class="pre">model.sample(&lt;num_rows&gt;)</span></code>. To test, try
<code class="docutils literal notranslate"><span class="pre">model.sample(10000)</span></code>. Note that the original table only had ~200
rows.</p>
</div>
</section>
<section id="save-and-load-the-model">
<h3>Save and Load the model<a class="headerlink" href="#save-and-load-the-model" title="Permalink to this headline">¶</a></h3>
<p>In many scenarios it will be convenient to generate synthetic versions
of your data directly in systems that do not have access to the original
data source. For example, if you may want to generate testing data on
the fly inside a testing environment that does not have access to your
production database. In these scenarios, fitting the model with real
data every time that you need to generate new data is feasible, so you
will need to fit a model in your production environment, save the fitted
model into a file, send this file to the testing environment and then
load it there to be able to <code class="docutils literal notranslate"><span class="pre">sample</span></code> from it.</p>
<p>Let’s see how this process works.</p>
<section id="save-and-share-the-model">
<h4>Save and share the model<a class="headerlink" href="#save-and-share-the-model" title="Permalink to this headline">¶</a></h4>
<p>Once you have fitted the model, all you need to do is call its <code class="docutils literal notranslate"><span class="pre">save</span></code>
method passing the name of the file in which you want to save the model.
Note that the extension of the filename is not relevant, but we will be
using the <code class="docutils literal notranslate"><span class="pre">.pkl</span></code> extension to highlight that the serialization
protocol used is
<a class="reference external" href="https://docs.python.org/3/library/pickle.html">pickle</a>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [9]: </span><span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;my_model.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This will have created a file called <code class="docutils literal notranslate"><span class="pre">my_model.pkl</span></code> in the same
directory in which you are running SDV.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If you inspect the generated file you will notice that its size is much
smaller than the size of the data that you used to generate it. This is
because the serialized model contains <strong>no information about the
original data</strong>, other than the parameters it needs to generate
synthetic versions of it. This means that you can safely share this
<code class="docutils literal notranslate"><span class="pre">my_model.pkl</span></code> file without the risk of disclosing any of your real
data!</p>
</div>
</section>
<section id="load-the-model-and-generate-new-data">
<h4>Load the model and generate new data<a class="headerlink" href="#load-the-model-and-generate-new-data" title="Permalink to this headline">¶</a></h4>
<p>The file you just generated can be sent over to the system where the
synthetic data will be generated. Once it is there, you can load it
using the <code class="docutils literal notranslate"><span class="pre">GaussianCopula.load</span></code> method, and then you are ready to
sample new data from the loaded instance:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [10]: </span><span class="n">loaded</span> <span class="o">=</span> <span class="n">GaussianCopula</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;my_model.pkl&#39;</span><span class="p">)</span>

<span class="gp">In [11]: </span><span class="n">new_data</span> <span class="o">=</span> <span class="n">loaded</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Notice that the system where the model is loaded needs to also have
<code class="docutils literal notranslate"><span class="pre">sdv</span></code> installed, otherwise it will not be able to load the model and
use it.</p>
</div>
</section>
</section>
<section id="specifying-the-primary-key-of-the-table">
<h3>Specifying the Primary Key of the table<a class="headerlink" href="#specifying-the-primary-key-of-the-table" title="Permalink to this headline">¶</a></h3>
<p>One of the first things that you may have noticed when looking at the demo
data is that there is a <code class="docutils literal notranslate"><span class="pre">student_id</span></code> column which acts as the primary
key of the table, and which is supposed to have unique values. Indeed,
if we look at the number of times that each value appears, we see that
all of them appear at most once:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [12]: </span><span class="n">data</span><span class="o">.</span><span class="n">student_id</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="gh">Out[12]: </span><span class="go">1</span>
</pre></div>
</div>
<p>However, if we look at the synthetic data that we generated, we observe
that there are some values that appear more than once:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [13]: </span><span class="n">new_data</span><span class="p">[</span><span class="n">new_data</span><span class="o">.</span><span class="n">student_id</span> <span class="o">==</span> <span class="n">new_data</span><span class="o">.</span><span class="n">student_id</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="gh">Out[13]: </span><span class="go"></span>
<span class="go">     student_id gender  second_perc  high_perc high_spec  degree_perc degree_type  work_experience  experience_years  employability_perc mba_spec  mba_perc   salary  placed start_date   end_date  duration</span>
<span class="go">55        17390      M        72.36      70.65  Commerce        68.26   Comm&amp;Mgmt            False                 1               64.01  Mkt&amp;Fin     60.45  24100.0    True 2020-02-27 2021-03-19      12.0</span>
<span class="go">90        17390      M        68.61      60.21   Science        59.18   Comm&amp;Mgmt            False                 0               85.05   Mkt&amp;HR     58.65      NaN   False        NaT        NaT       NaN</span>
<span class="go">129       17390      M        87.09      61.22   Science        61.83    Sci&amp;Tech            False                 2               70.55   Mkt&amp;HR     59.12  34600.0    True 2020-02-12 2020-09-26       7.0</span>
<span class="go">159       17390      F        63.73      64.40  Commerce        62.82   Comm&amp;Mgmt            False                 0               94.91   Mkt&amp;HR     65.64      NaN   False        NaT        NaT       NaN</span>
</pre></div>
</div>
<p>This happens because the model was not notified at any point about the
fact that the <code class="docutils literal notranslate"><span class="pre">student_id</span></code> had to be unique, so when it generates new
data it will provoke collisions sooner or later. In order to solve this,
we can pass the argument <code class="docutils literal notranslate"><span class="pre">primary_key</span></code> to our model when we create it,
indicating the name of the column that is the index of the table.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [14]: </span><span class="n">model</span> <span class="o">=</span> <span class="n">GaussianCopula</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="n">primary_key</span><span class="o">=</span><span class="s1">&#39;student_id&#39;</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [15]: </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="gp">In [16]: </span><span class="n">new_data</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>

<span class="gp">In [17]: </span><span class="n">new_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[17]: </span><span class="go"></span>
<span class="go">   student_id gender  second_perc  high_perc high_spec  degree_perc degree_type  work_experience  experience_years  employability_perc mba_spec  mba_perc   salary  placed start_date   end_date  duration</span>
<span class="go">0           0      M        85.60      66.79  Commerce        64.32   Comm&amp;Mgmt            False                 1               62.52  Mkt&amp;Fin     55.99  22000.0    True 2020-01-02 2020-07-20       7.0</span>
<span class="go">1           1      M        58.88      63.73  Commerce        73.80   Comm&amp;Mgmt            False                 0               81.39  Mkt&amp;Fin     60.53  28800.0    True 2020-01-08 2020-03-29       4.0</span>
<span class="go">2           2      M        76.81      62.95   Science        65.02    Sci&amp;Tech            False                 1               68.74   Mkt&amp;HR     58.62  33400.0    True 2020-01-08 2020-09-15       9.0</span>
<span class="go">3           3      M        78.43      97.70   Science        83.25   Comm&amp;Mgmt            False                 0               66.17   Mkt&amp;HR     65.04  28800.0    True 2020-02-12 2020-03-14       3.0</span>
<span class="go">4           4      F        61.87      41.17   Science        52.50   Comm&amp;Mgmt            False                 2               55.64  Mkt&amp;Fin     54.26  48100.0    True 2020-03-10 2020-08-17       4.0</span>
</pre></div>
</div>
<p>As a result, the model will learn that this column must be unique and
generate a unique sequence of values for the column:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [18]: </span><span class="n">new_data</span><span class="o">.</span><span class="n">student_id</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="gh">Out[18]: </span><span class="go">1</span>
</pre></div>
</div>
</section>
<section id="anonymizing-personally-identifiable-information-pii">
<h3>Anonymizing Personally Identifiable Information (PII)<a class="headerlink" href="#anonymizing-personally-identifiable-information-pii" title="Permalink to this headline">¶</a></h3>
<p>There will be many cases where the data will contain Personally
Identifiable Information which we cannot disclose. In these cases, we
will want our Tabular Models to replace the information within these
fields with fake, simulated data that looks similar to the real one but
does not contain any of the original values.</p>
<p>Let’s load a new dataset that contains a PII field, the
<code class="docutils literal notranslate"><span class="pre">student_placements_pii</span></code> demo, and try to generate synthetic versions
of it that do not contain any of the PII fields.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">student_placements_pii</span></code> dataset is a modified version of the
<code class="docutils literal notranslate"><span class="pre">student_placements</span></code> dataset with one new field, <code class="docutils literal notranslate"><span class="pre">address</span></code>, which
contains PII information about the students. Notice that this additional
<code class="docutils literal notranslate"><span class="pre">address</span></code> field has been simulated and does not correspond to data
from the real users.</p>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [19]: </span><span class="n">data_pii</span> <span class="o">=</span> <span class="n">load_tabular_demo</span><span class="p">(</span><span class="s1">&#39;student_placements_pii&#39;</span><span class="p">)</span>

<span class="gp">In [20]: </span><span class="n">data_pii</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[20]: </span><span class="go"></span>
<span class="go">   student_id                                            address gender  second_perc  high_perc high_spec  degree_perc degree_type  work_experience  experience_years  employability_perc mba_spec  mba_perc   salary  placed start_date   end_date  duration</span>
<span class="go">0       17264        70304 Baker Turnpike\nEricborough, MS 15086      M        67.00      91.00  Commerce        58.00    Sci&amp;Tech            False                 0                55.0   Mkt&amp;HR     58.80  27000.0    True 2020-07-23 2020-10-12       3.0</span>
<span class="go">1       17265    805 Herrera Avenue Apt. 134\nMaryview, NJ 36510      M        79.33      78.33   Science        77.48    Sci&amp;Tech             True                 1                86.5  Mkt&amp;Fin     66.28  20000.0    True 2020-01-11 2020-04-09       3.0</span>
<span class="go">2       17266        3702 Bradley Island\nNorth Victor, FL 12268      M        65.00      68.00      Arts        64.00   Comm&amp;Mgmt            False                 0                75.0  Mkt&amp;Fin     57.80  25000.0    True 2020-01-26 2020-07-13       6.0</span>
<span class="go">3       17267                   Unit 0879 Box 3878\nDPO AP 42663      M        56.00      52.00   Science        52.00    Sci&amp;Tech            False                 0                66.0   Mkt&amp;HR     59.43      NaN   False        NaT        NaT       NaN</span>
<span class="go">4       17268  96493 Kelly Canyon Apt. 145\nEast Steven, NC 3...      M        85.80      73.60  Commerce        73.30   Comm&amp;Mgmt            False                 0                96.8  Mkt&amp;Fin     55.50  42500.0    True 2020-07-04 2020-09-27       3.0</span>
</pre></div>
</div>
<p>If we use our tabular model on this new data we will see how the
synthetic data that it generates discloses the addresses from the real
students:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [21]: </span><span class="n">model</span> <span class="o">=</span> <span class="n">GaussianCopula</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="n">primary_key</span><span class="o">=</span><span class="s1">&#39;student_id&#39;</span><span class="p">,</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [22]: </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_pii</span><span class="p">)</span>

<span class="gp">In [23]: </span><span class="n">new_data_pii</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>

<span class="gp">In [24]: </span><span class="n">new_data_pii</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[24]: </span><span class="go"></span>
<span class="go">   student_id                                            address gender  second_perc  high_perc high_spec  degree_perc degree_type  work_experience  experience_years  employability_perc mba_spec  mba_perc   salary  placed start_date   end_date  duration</span>
<span class="go">0           0  67904 Bowen Ways Suite 290\nHernandezville, VT...      M        59.25      61.04  Commerce        55.89   Comm&amp;Mgmt            False                 0               88.03  Mkt&amp;Fin     51.21      NaN   False        NaT        NaT       NaN</span>
<span class="go">1           1          4118 Patel Lodge\nEast Kristina, KY 49930      F        65.81      63.71   Science        65.63    Sci&amp;Tech            False                 0               67.09   Mkt&amp;HR     74.46      NaN   False        NaT        NaT       NaN</span>
<span class="go">2           2  2120 Kelsey Glens Apt. 004\nNew Markland, CA 7...      M        50.67      48.56  Commerce        54.03   Comm&amp;Mgmt            False                 1               55.49   Mkt&amp;HR     61.27  23500.0    True 2020-01-23 2020-11-22       9.0</span>
<span class="go">3           3  2348 Washington Oval Apt. 978\nOwensbury, HI 7...      M        58.88      64.64   Science        71.88    Sci&amp;Tech            False                 0               85.93  Mkt&amp;Fin     68.01      NaN   False        NaT        NaT       NaN</span>
<span class="go">4           4  336 Davis Drives Apt. 411\nNew Reginashire, CT...      M        65.67      55.43   Science        65.55   Comm&amp;Mgmt            False                 0               73.58  Mkt&amp;Fin     56.59      NaN   False        NaT        NaT       NaN</span>
</pre></div>
</div>
<p>More specifically, we can see how all the addresses that have been generated
actually come from the original dataset:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [25]: </span><span class="n">new_data_pii</span><span class="o">.</span><span class="n">address</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">data_pii</span><span class="o">.</span><span class="n">address</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gh">Out[25]: </span><span class="go">200</span>
</pre></div>
</div>
<p>In order to solve this, we can pass an additional argument
<code class="docutils literal notranslate"><span class="pre">anonymize_fields</span></code> to our model when we create the instance. This
<code class="docutils literal notranslate"><span class="pre">anonymize_fields</span></code> argument will need to be a dictionary that
contains:</p>
<ul class="simple">
<li><p>The name of the field that we want to anonymize.</p></li>
<li><p>The category of the field that we want to use when we generate fake
values for it.</p></li>
</ul>
<p>The list complete list of possible categories can be seen in the <a class="reference external" href="https://faker.readthedocs.io/en/master/providers.html">Faker
Providers</a>
page, and it contains a huge list of concepts such as:</p>
<ul class="simple">
<li><p>name</p></li>
<li><p>address</p></li>
<li><p>country</p></li>
<li><p>city</p></li>
<li><p>ssn</p></li>
<li><p>credit_card_number</p></li>
<li><p>credit_card_expire</p></li>
<li><p>credit_card_security_code</p></li>
<li><p>email</p></li>
<li><p>telephone</p></li>
<li><p>…</p></li>
</ul>
<p>In this case, since the field is an e-mail address, we will pass a
dictionary indicating the category <code class="docutils literal notranslate"><span class="pre">address</span></code></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [26]: </span><span class="n">model</span> <span class="o">=</span> <span class="n">GaussianCopula</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="n">primary_key</span><span class="o">=</span><span class="s1">&#39;student_id&#39;</span><span class="p">,</span>
<span class="gp">   ....: </span>    <span class="n">anonymize_fields</span><span class="o">=</span><span class="p">{</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;address&#39;</span><span class="p">:</span> <span class="s1">&#39;address&#39;</span>
<span class="gp">   ....: </span>    <span class="p">}</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [27]: </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_pii</span><span class="p">)</span>
</pre></div>
</div>
<p>As a result, we can see how the real <code class="docutils literal notranslate"><span class="pre">address</span></code> values have been
replaced by other fake addresses:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [28]: </span><span class="n">new_data_pii</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>

<span class="gp">In [29]: </span><span class="n">new_data_pii</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[29]: </span><span class="go"></span>
<span class="go">   student_id                                            address gender  second_perc  high_perc high_spec  degree_perc degree_type  work_experience  experience_years  employability_perc mba_spec  mba_perc   salary  placed start_date   end_date  duration</span>
<span class="go">0           0  532 Leach Plaza Suite 967\nPort Codymouth, LA ...      M        51.67      53.02   Science        60.25    Sci&amp;Tech            False                 0               82.72   Mkt&amp;HR     64.67      NaN   False        NaT        NaT       NaN</span>
<span class="go">1           1   31804 Joel Prairie Apt. 293\nSmallfort, AZ 73119      M        76.43      74.25  Commerce        64.34   Comm&amp;Mgmt            False                 1               50.20  Mkt&amp;Fin     59.76  28300.0    True 2020-02-21 2020-09-21       6.0</span>
<span class="go">2           2         475 Burton Prairie\nEast Timothy, MS 40344      F        63.19      56.84  Commerce        65.87   Comm&amp;Mgmt            False                 1               86.78  Mkt&amp;Fin     59.52      NaN   False        NaT        NaT       NaN</span>
<span class="go">3           3     9117 Mark Tunnel Apt. 346\nCurtiston, TN 49030      M        63.92      59.38   Science        69.65    Sci&amp;Tech            False                 0               61.48   Mkt&amp;HR     66.44      NaN   False        NaT        NaT       NaN</span>
<span class="go">4           4                   Unit 8017 Box 7780\nDPO AA 30450      M        84.46      67.44  Commerce        73.53   Comm&amp;Mgmt            False                 1               77.94  Mkt&amp;Fin     63.98  26600.0    True 2020-01-15 2020-09-11       9.0</span>
</pre></div>
</div>
<p>Which means that none of the original addresses can be found in the sampled
data:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [30]: </span><span class="n">data_pii</span><span class="o">.</span><span class="n">address</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">new_data_pii</span><span class="o">.</span><span class="n">address</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gh">Out[30]: </span><span class="go">0</span>
</pre></div>
</div>
</section>
</section>
<section id="advanced-usage">
<h2>Advanced Usage<a class="headerlink" href="#advanced-usage" title="Permalink to this headline">¶</a></h2>
<p>Now that we have discovered the basics, let’s go over a few more
advanced usage examples and see the different arguments that we can pass
to our <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> Model in order to customize it to our needs.</p>
<section id="how-to-set-transforms-to-use">
<h3>How to set transforms to use?<a class="headerlink" href="#how-to-set-transforms-to-use" title="Permalink to this headline">¶</a></h3>
<p>One thing that you may have noticed when executing the previous steps is
that the fitting process took much longer on the
<code class="docutils literal notranslate"><span class="pre">student_placements_pii</span></code> dataset than it took on the previous version
that did not contain the student <code class="docutils literal notranslate"><span class="pre">address</span></code>. This happens because the
<code class="docutils literal notranslate"><span class="pre">address</span></code> field is interpreted as a categorical variable, which the
<code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> <a class="reference external" href="https://en.wikipedia.org/wiki/One-hot">one-hot
encoded</a> generating 215 new
columns that it had to learn afterwards.</p>
<p>This transformation, which in this case was very inefficient, happens
because the Tabular Models apply <a class="reference external" href="https://github.com/sdv-dev/RDT">Reversible Data
Transforms</a> under the hood to
transform all the non-numerical variables, which the underlying models
cannot handle, into numerical representations which they can properly
work with. In the case of the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code>, the default
transformation is a One-Hot encoding, which can work very well with
variables that have a small number of different values, but which is
very inefficient in cases where there is a large number of values.</p>
<p>For this reason, the Tabular Models have an additional argument called
<code class="docutils literal notranslate"><span class="pre">field_transformers</span></code> that let you select which transformer to apply to
each column. This <code class="docutils literal notranslate"><span class="pre">field_transformers</span></code> argument must be passed as a
<code class="docutils literal notranslate"><span class="pre">dict</span></code> which contains the name of the fields for which we want to use
a transformer different than the default, and the name of the
transformer that we want to use.</p>
<p>Possible transformer names are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">integer</span></code>: Uses a <code class="docutils literal notranslate"><span class="pre">NumericalTransformer</span></code> of dtype <code class="docutils literal notranslate"><span class="pre">int</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">float</span></code>: Uses a <code class="docutils literal notranslate"><span class="pre">NumericalTransformer</span></code> of dtype <code class="docutils literal notranslate"><span class="pre">float</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">categorical</span></code>: Uses a <code class="docutils literal notranslate"><span class="pre">CategoricalTransformer</span></code> without gaussian
noise.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">categorical_fuzzy</span></code>: Uses a <code class="docutils literal notranslate"><span class="pre">CategoricalTransformer</span></code> adding
gaussian noise.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">one_hot_encoding</span></code>: Uses a <code class="docutils literal notranslate"><span class="pre">OneHotEncodingTransformer</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">label_encoding</span></code>: Uses a <code class="docutils literal notranslate"><span class="pre">LabelEncodingTransformer</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code>: Uses a <code class="docutils literal notranslate"><span class="pre">BooleanTransformer</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">datetime</span></code>: Uses a <code class="docutils literal notranslate"><span class="pre">DatetimeTransformer</span></code>.</p></li>
</ul>
<p><strong>NOTE</strong>: For additional details about each one of the transformers,
please visit <a class="reference external" href="https://github.com/sdv-dev/RDT">RDT</a></p>
<p>Let’s now try to improve the previous fitting process by changing the
transformer that we use for the <code class="docutils literal notranslate"><span class="pre">address</span></code> field to something other
than the default. As an example, we will use the <code class="docutils literal notranslate"><span class="pre">label_encoding</span></code>
transformer, which instead of generating one column for each possible
value, it just replaces each value with a unique integer value.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [31]: </span><span class="n">model</span> <span class="o">=</span> <span class="n">GaussianCopula</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="n">primary_key</span><span class="o">=</span><span class="s1">&#39;student_id&#39;</span><span class="p">,</span>
<span class="gp">   ....: </span>    <span class="n">anonymize_fields</span><span class="o">=</span><span class="p">{</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;address&#39;</span><span class="p">:</span> <span class="s1">&#39;address&#39;</span>
<span class="gp">   ....: </span>    <span class="p">},</span>
<span class="gp">   ....: </span>    <span class="n">field_transformers</span><span class="o">=</span><span class="p">{</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;address&#39;</span><span class="p">:</span> <span class="s1">&#39;label_encoding&#39;</span>
<span class="gp">   ....: </span>    <span class="p">}</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [32]: </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_pii</span><span class="p">)</span>

<span class="gp">In [33]: </span><span class="n">new_data_pii</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>

<span class="gp">In [34]: </span><span class="n">new_data_pii</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[34]: </span><span class="go"></span>
<span class="go">   student_id                                            address gender  second_perc  high_perc high_spec  degree_perc degree_type  work_experience  experience_years  employability_perc mba_spec  mba_perc   salary  placed start_date   end_date  duration</span>
<span class="go">0           0  85299 Desiree Lock Suite 467\nLake Christyburg...      M        71.60      57.61  Commerce        61.53    Sci&amp;Tech            False                 0               87.46  Mkt&amp;Fin     63.85  44600.0    True 2020-04-22 2020-08-28       3.0</span>
<span class="go">1           1   601 Diane Locks Apt. 160\nSouth Joshua, AR 28634      M        88.93      77.65   Science        82.97    Sci&amp;Tech            False                 2               81.52  Mkt&amp;Fin     70.84  31800.0    True 2020-01-18 2020-12-23      10.0</span>
<span class="go">2           2           458 Brady Crescent\nLake Wanda, MI 52835      M        65.72      57.51   Science        62.93    Sci&amp;Tech            False                 1               82.46  Mkt&amp;Fin     67.32  36800.0    True 2020-01-06 2020-08-02       6.0</span>
<span class="go">3           3                   Unit 8006 Box 5395\nDPO AE 53983      M        68.94      67.67   Science        53.32   Comm&amp;Mgmt            False                 0               90.19  Mkt&amp;Fin     67.50  24800.0    True 2020-01-14 2020-01-22       3.0</span>
<span class="go">4           4  87678 Antonio Gateway Apt. 210\nHumphreyburgh,...      M        69.26      67.99  Commerce        63.67   Comm&amp;Mgmt            False                 0               85.81  Mkt&amp;Fin     54.99      NaN   False        NaT        NaT       NaN</span>
</pre></div>
</div>
</section>
<section id="setting-bounds-and-specifying-rounding-for-numerical-columns">
<h3>Setting Bounds and Specifying Rounding for Numerical Columns<a class="headerlink" href="#setting-bounds-and-specifying-rounding-for-numerical-columns" title="Permalink to this headline">¶</a></h3>
<p>By default, the model will learn the upper and lower bounds of the
input data, and use that for sampling. This means that all sampled data
will be between the maximum and minimum values found in the original
dataset for each numeric column. This option can be overwritten using the
<code class="docutils literal notranslate"><span class="pre">min_value</span></code> and <code class="docutils literal notranslate"><span class="pre">max_value</span></code> model arguments. These values can either
be set to a numeric value, set to <code class="docutils literal notranslate"><span class="pre">'auto'</span></code> which is the default setting,
or set to <code class="docutils literal notranslate"><span class="pre">None</span></code> which will mean the column is boundless.</p>
<p>The model will also learn the number of decimal places to round to by default.
This option can be overwritten using the <code class="docutils literal notranslate"><span class="pre">rounding</span></code> parameter. The value can
be an int specifying how many decimal places to round to, <code class="docutils literal notranslate"><span class="pre">'auto'</span></code> which is
the default setting, or <code class="docutils literal notranslate"><span class="pre">None</span></code> which means the data will not be rounded.</p>
<p>Since we may want to sample values outside of the ranges in the original data,
let’s pass the <code class="docutils literal notranslate"><span class="pre">min_value</span></code> and <code class="docutils literal notranslate"><span class="pre">max_value</span></code> arguments as <cite>None</cite> to the model.
To keep the number of decimals consistent across columns, we can set <code class="docutils literal notranslate"><span class="pre">rounding</span></code>
to be 2.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [35]: </span><span class="n">model</span> <span class="o">=</span> <span class="n">GaussianCopula</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="n">primary_key</span><span class="o">=</span><span class="s1">&#39;student_id&#39;</span><span class="p">,</span>
<span class="gp">   ....: </span>    <span class="n">min_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">   ....: </span>    <span class="n">max_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">   ....: </span>    <span class="n">rounding</span><span class="o">=</span><span class="mi">2</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [36]: </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="gp">In [37]: </span><span class="n">unbounded_data</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="gp">In [38]: </span><span class="n">unbounded_data</span>
<span class="gh">Out[38]: </span><span class="go"></span>
<span class="go">   student_id gender  second_perc  high_perc high_spec  degree_perc degree_type  work_experience  experience_years  employability_perc mba_spec  mba_perc    salary  placed start_date   end_date  duration</span>
<span class="go">0           0      F        65.83      53.01   Science        63.75   Comm&amp;Mgmt            False                 0               71.23   Mkt&amp;HR     70.96       NaN   False        NaT        NaT       NaN</span>
<span class="go">1           1      M        53.99      56.19   Science        65.49      Others            False                 0               74.08  Mkt&amp;Fin     64.41  23824.79    True 2020-04-27 2021-01-06      7.71</span>
<span class="go">2           2      M        67.87      69.85   Science        58.31   Comm&amp;Mgmt            False                 1               90.69   Mkt&amp;HR     51.99  24745.18    True 2020-03-19 2020-12-18      6.87</span>
<span class="go">3           3      F        54.00      54.48  Commerce        66.37   Comm&amp;Mgmt            False                 0               58.70   Mkt&amp;HR     51.26  30644.01    True 2020-04-23 2020-11-06      6.11</span>
<span class="go">4           4      F        67.19      62.81  Commerce        62.56   Comm&amp;Mgmt            False                 1               87.80  Mkt&amp;Fin     59.48  27695.33    True 2020-09-19 2021-01-11      5.28</span>
<span class="go">5           5      M        60.42      62.21  Commerce        62.41   Comm&amp;Mgmt            False                 1               52.98  Mkt&amp;Fin     53.33  25064.23    True 2020-01-09 2020-07-11      6.85</span>
<span class="go">6           6      M        75.09      64.92  Commerce        75.44   Comm&amp;Mgmt            False                 0               56.79   Mkt&amp;HR     64.45  21734.00    True 2020-03-01 2020-12-01     10.07</span>
<span class="go">7           7      M        86.24      67.27   Science        71.92    Sci&amp;Tech            False                 0               78.82   Mkt&amp;HR     61.84  24879.48    True 2020-02-22 2020-08-29      3.30</span>
<span class="go">8           8      M        58.39      53.17   Science        57.11    Sci&amp;Tech            False                 1               62.94   Mkt&amp;HR     54.71  27692.05    True 2020-01-09 2020-07-20      6.53</span>
<span class="go">9           9      M        64.29      57.36   Science        68.38   Comm&amp;Mgmt            False                 0               93.10  Mkt&amp;Fin     60.57       NaN   False        NaT        NaT       NaN</span>
</pre></div>
</div>
<p>As you may notice, the sampled data may have values outside the range of
the original data.</p>
</section>
<section id="exploring-the-probability-distributions">
<h3>Exploring the Probability Distributions<a class="headerlink" href="#exploring-the-probability-distributions" title="Permalink to this headline">¶</a></h3>
<p>During the previous steps, every time we fitted the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code>
it performed the following operations:</p>
<ol class="arabic simple">
<li><p>Learn the format and data types of the passed data</p></li>
<li><p>Transform the non-numerical and null data using <a class="reference external" href="https://github.com/sdv-dev/RDT">Reversible Data
Transforms</a> to obtain a fully
numerical representation of the data from which we can learn the
probability distributions.</p></li>
<li><p>Learn the probability distribution of each column from the table</p></li>
<li><p>Transform the values of each numerical column by converting them
to their marginal distribution CDF values and then applying an
inverse CDF transformation of a standard normal on them.</p></li>
<li><p>Learn the correlations of the newly generated random variables.</p></li>
</ol>
<p>After this, when we used the model to generate new data for our table
using the <code class="docutils literal notranslate"><span class="pre">sample</span></code> method, it did:</p>
<ol class="arabic simple" start="5">
<li><p>Sample from a Multivariate Standard Normal distribution with the
learned correlations.</p></li>
<li><p>Revert the sampled values by computing their standard normal CDF
and then applying the inverse CDF of their marginal distributions.</p></li>
<li><p>Revert the RDT transformations to go back to the original data
format.</p></li>
</ol>
<p>As you can see, during these steps the <em>Marginal Probability
Distributions</em> have a very important role, since the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code>
had to learn and reproduce the individual distributions of each column
in our table. We can explore the distributions which the
<code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> used to model each column using its
<code class="docutils literal notranslate"><span class="pre">get_distributions</span></code> method:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [39]: </span><span class="n">model</span> <span class="o">=</span> <span class="n">GaussianCopula</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="n">primary_key</span><span class="o">=</span><span class="s1">&#39;student_id&#39;</span><span class="p">,</span>
<span class="gp">   ....: </span>    <span class="n">min_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">   ....: </span>    <span class="n">max_value</span><span class="o">=</span><span class="kc">None</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [40]: </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="gp">In [41]: </span><span class="n">distributions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_distributions</span><span class="p">()</span>
</pre></div>
</div>
<p>This will return us a <code class="docutils literal notranslate"><span class="pre">dict</span></code> which contains the name of the
distribution class used for each column:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [42]: </span><span class="n">distributions</span>
<span class="gh">Out[42]: </span><span class="go"></span>
<span class="go">{&#39;second_perc&#39;: &#39;copulas.univariate.truncated_gaussian.TruncatedGaussian&#39;,</span>
<span class="go"> &#39;high_perc&#39;: &#39;copulas.univariate.log_laplace.LogLaplace&#39;,</span>
<span class="go"> &#39;degree_perc&#39;: &#39;copulas.univariate.student_t.StudentTUnivariate&#39;,</span>
<span class="go"> &#39;work_experience&#39;: &#39;copulas.univariate.student_t.StudentTUnivariate&#39;,</span>
<span class="go"> &#39;experience_years&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,</span>
<span class="go"> &#39;employability_perc&#39;: &#39;copulas.univariate.truncated_gaussian.TruncatedGaussian&#39;,</span>
<span class="go"> &#39;mba_perc&#39;: &#39;copulas.univariate.gamma.GammaUnivariate&#39;,</span>
<span class="go"> &#39;placed&#39;: &#39;copulas.univariate.gamma.GammaUnivariate&#39;,</span>
<span class="go"> &#39;gender#0&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,</span>
<span class="go"> &#39;gender#1&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,</span>
<span class="go"> &#39;high_spec#0&#39;: &#39;copulas.univariate.gamma.GammaUnivariate&#39;,</span>
<span class="go"> &#39;high_spec#1&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,</span>
<span class="go"> &#39;high_spec#2&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,</span>
<span class="go"> &#39;degree_type#0&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,</span>
<span class="go"> &#39;degree_type#1&#39;: &#39;copulas.univariate.student_t.StudentTUnivariate&#39;,</span>
<span class="go"> &#39;degree_type#2&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,</span>
<span class="go"> &#39;mba_spec#0&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,</span>
<span class="go"> &#39;mba_spec#1&#39;: &#39;copulas.univariate.gamma.GammaUnivariate&#39;,</span>
<span class="go"> &#39;salary#0&#39;: &#39;copulas.univariate.gamma.GammaUnivariate&#39;,</span>
<span class="go"> &#39;salary#1&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,</span>
<span class="go"> &#39;start_date#0&#39;: &#39;copulas.univariate.gamma.GammaUnivariate&#39;,</span>
<span class="go"> &#39;start_date#1&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,</span>
<span class="go"> &#39;end_date#0&#39;: &#39;copulas.univariate.gamma.GammaUnivariate&#39;,</span>
<span class="go"> &#39;end_date#1&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,</span>
<span class="go"> &#39;duration#0&#39;: &#39;copulas.univariate.student_t.StudentTUnivariate&#39;,</span>
<span class="go"> &#39;duration#1&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this list we will see multiple distributions for each one of the
columns that we have in our data. This is because the RDT
transformations used to encode the data numerically often use more than
one column to represent each one of the input variables.</p>
</div>
<p>Let’s explore the individual distribution of one of the columns in our
data to better understand how the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> processed them and
see if we can improve the results by manually specifying a different
distribution. For example, let’s explore the <code class="docutils literal notranslate"><span class="pre">experience_years</span></code> column
by looking at the frequency of its values within the original data:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [43]: </span><span class="n">data</span><span class="o">.</span><span class="n">experience_years</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="gh">Out[43]: </span><span class="go"></span>
<span class="go">0    141</span>
<span class="go">1     65</span>
<span class="go">2      8</span>
<span class="go">3      1</span>
<span class="go">Name: experience_years, dtype: int64</span>

<span class="gp">In [44]: </span><span class="n">data</span><span class="o">.</span><span class="n">experience_years</span><span class="o">.</span><span class="n">hist</span><span class="p">();</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/experience_years_1.png"><img alt="../../_images/experience_years_1.png" src="../../_images/experience_years_1.png" style="width: 4in;" /></a>
<p>By observing the data we can see that the behavior of the values in this
column is very similar to a Gamma or even some types of Beta
distribution, where the majority of the values are 0 and the frequency
decreases as the values increase.</p>
<p>Was the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> able to capture this distribution on its own?</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [45]: </span><span class="n">distributions</span><span class="p">[</span><span class="s1">&#39;experience_years&#39;</span><span class="p">]</span>
<span class="gh">Out[45]: </span><span class="go">&#39;copulas.univariate.gaussian.GaussianUnivariate&#39;</span>
</pre></div>
</div>
<p>It seems that it was not, as it rather thought that the behavior was
closer to a Gaussian distribution. And, as a result, we can see how the
generated values now contain negative values which are invalid for this
column:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [46]: </span><span class="n">new_data</span><span class="o">.</span><span class="n">experience_years</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="gh">Out[46]: </span><span class="go"></span>
<span class="go">0    120</span>
<span class="go">1     71</span>
<span class="go">2      9</span>
<span class="go">Name: experience_years, dtype: int64</span>

<span class="gp">In [47]: </span><span class="n">new_data</span><span class="o">.</span><span class="n">experience_years</span><span class="o">.</span><span class="n">hist</span><span class="p">();</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/experience_years_2.png"><img alt="../../_images/experience_years_2.png" src="../../_images/experience_years_2.png" style="width: 4in;" /></a>
<p>Let’s see how we can improve this situation by passing the
<code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> the exact distribution that we want it to use for
this column.</p>
</section>
<section id="setting-distributions-for-individual-variables">
<h3>Setting distributions for individual variables<a class="headerlink" href="#setting-distributions-for-individual-variables" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> class offers the possibility to indicate which
distribution to use for each one of the columns in the table, in order
to solve situations like the one that we just described. In order to do
this, we need to pass a <code class="docutils literal notranslate"><span class="pre">field_distributions</span></code> argument with <code class="docutils literal notranslate"><span class="pre">dict</span></code>
that indicates the distribution that we want to use for each column.</p>
<p>Possible values for the distribution argument are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">univariate</span></code>: Let <code class="docutils literal notranslate"><span class="pre">copulas</span></code> select the optimal univariate
distribution. This may result in non-parametric models being used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parametric</span></code>: Let <code class="docutils literal notranslate"><span class="pre">copulas</span></code> select the optimal univariate
distribution, but restrict the selection to parametric distributions
only.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bounded</span></code>: Let <code class="docutils literal notranslate"><span class="pre">copulas</span></code> select the optimal univariate
distribution, but restrict the selection to bounded distributions
only. This may result in non-parametric models being used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">semi_bounded</span></code>: Let <code class="docutils literal notranslate"><span class="pre">copulas</span></code> select the optimal univariate
distribution, but restrict the selection to semi-bounded
distributions only. This may result in non-parametric models being
used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parametric_bounded</span></code>: Let <code class="docutils literal notranslate"><span class="pre">copulas</span></code> select the optimal univariate
distribution, but restrict the selection to parametric and bounded
distributions only.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parametric_semi_bounded</span></code>: Let <code class="docutils literal notranslate"><span class="pre">copulas</span></code> select the optimal
univariate distribution, but restrict the selection to parametric and
semi-bounded distributions only.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gaussian</span></code>: Use a Gaussian distribution.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gamma</span></code>: Use a Gamma distribution.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">beta</span></code>: Use a Beta distribution.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">student_t</span></code>: Use a Student T distribution.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gaussian_kde</span></code>: Use a GaussianKDE distribution. This model is
non-parametric, so using this will make <code class="docutils literal notranslate"><span class="pre">get_parameters</span></code> unusable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">truncated_gaussian</span></code>: Use a Truncated Gaussian distribution.</p></li>
</ul>
<p>Let’s see what happens if we make the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> use the
<code class="docutils literal notranslate"><span class="pre">gamma</span></code> distribution for our column.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [48]: </span><span class="kn">from</span> <span class="nn">sdv.tabular</span> <span class="kn">import</span> <span class="n">GaussianCopula</span>

<span class="gp">In [49]: </span><span class="n">model</span> <span class="o">=</span> <span class="n">GaussianCopula</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="n">primary_key</span><span class="o">=</span><span class="s1">&#39;student_id&#39;</span><span class="p">,</span>
<span class="gp">   ....: </span>    <span class="n">field_distributions</span><span class="o">=</span><span class="p">{</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;experience_years&#39;</span><span class="p">:</span> <span class="s1">&#39;gamma&#39;</span>
<span class="gp">   ....: </span>    <span class="p">},</span>
<span class="gp">   ....: </span>    <span class="n">min_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">   ....: </span>    <span class="n">max_value</span><span class="o">=</span><span class="kc">None</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [50]: </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>After this, we can see how the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> used the indicated
distribution for the <code class="docutils literal notranslate"><span class="pre">experience_years</span></code> column</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [51]: </span><span class="n">model</span><span class="o">.</span><span class="n">get_distributions</span><span class="p">()[</span><span class="s1">&#39;experience_years&#39;</span><span class="p">]</span>
<span class="gh">Out[51]: </span><span class="go">&#39;copulas.univariate.gamma.GammaUnivariate&#39;</span>
</pre></div>
</div>
<p>And, as a result, we can see how the generated data now have a
behavior which is closer to the original data and always stays within
the valid values range.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [52]: </span><span class="n">new_data</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="gp">In [53]: </span><span class="n">new_data</span><span class="o">.</span><span class="n">experience_years</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="gh">Out[53]: </span><span class="go"></span>
<span class="go">0    198</span>
<span class="go">1     15</span>
<span class="go">2      2</span>
<span class="go">Name: experience_years, dtype: int64</span>

<span class="gp">In [54]: </span><span class="n">new_data</span><span class="o">.</span><span class="n">experience_years</span><span class="o">.</span><span class="n">hist</span><span class="p">();</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/experience_years_3.png"><img alt="../../_images/experience_years_3.png" src="../../_images/experience_years_3.png" style="width: 4in;" /></a>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Even though there are situations like the one shown above where manually
choosing a distribution seems to give better results, in most cases the
<code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> will be able to find the optimal distribution on its
own, making this manual search of the marginal distributions necessary
on very little occasions.</p>
</div>
</section>
<section id="conditional-sampling">
<h3>Conditional Sampling<a class="headerlink" href="#conditional-sampling" title="Permalink to this headline">¶</a></h3>
<p>As the name implies, conditional sampling allows us to sample from a conditional
distribution using the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> model, which means we can generate only values that
satisfy certain conditions. These conditional values can be passed to the <code class="docutils literal notranslate"><span class="pre">conditions</span></code>
parameter in the <code class="docutils literal notranslate"><span class="pre">sample</span></code> method either as a dataframe or a dictionary.</p>
<p>In case a dictionary is passed, the model will generate as many rows as requested,
all of which will satisfy the specified conditions, such as <code class="docutils literal notranslate"><span class="pre">gender</span> <span class="pre">=</span> <span class="pre">M</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [55]: </span><span class="n">conditions</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">   ....: </span>    <span class="s1">&#39;gender&#39;</span><span class="p">:</span> <span class="s1">&#39;M&#39;</span>
<span class="gp">   ....: </span><span class="p">}</span>
<span class="gp">   ....: </span>

<span class="gp">In [56]: </span><span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">conditions</span><span class="o">=</span><span class="n">conditions</span><span class="p">)</span>
<span class="gh">Out[56]: </span><span class="go"></span>
<span class="go">   student_id gender  second_perc  high_perc high_spec  degree_perc degree_type  work_experience  experience_years  employability_perc mba_spec  mba_perc   salary  placed start_date   end_date  duration</span>
<span class="go">0           0      M        75.24      64.32   Science        71.51    Sci&amp;Tech            False                 0               55.72   Mkt&amp;HR     59.54  31800.0    True 2020-04-25 2020-07-16       3.0</span>
<span class="go">1           1      M        84.73      78.50  Commerce        69.63   Comm&amp;Mgmt            False                 0               90.75   Mkt&amp;HR     65.44  29100.0    True 2020-03-03 2020-07-21       3.0</span>
<span class="go">2           2      M        88.43      67.27   Science        63.42    Sci&amp;Tech            False                 1               65.21   Mkt&amp;HR     52.55  27500.0    True 2020-01-05 2020-11-05      10.0</span>
<span class="go">3           3      M        58.89      64.04  Commerce        58.21   Comm&amp;Mgmt            False                 0               50.92  Mkt&amp;Fin     69.31  22300.0    True 2020-01-16 2020-09-13       6.0</span>
<span class="go">4           4      M        47.63      64.44  Commerce        64.07   Comm&amp;Mgmt            False                 0               50.19   Mkt&amp;HR     59.52      NaN   False        NaT        NaT       NaN</span>
</pre></div>
</div>
<p>It’s also possible to condition on multiple columns, such as
<code class="docutils literal notranslate"><span class="pre">gender</span> <span class="pre">=</span> <span class="pre">M,</span> <span class="pre">'experience_years':</span> <span class="pre">0</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [57]: </span><span class="n">conditions</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">   ....: </span>    <span class="s1">&#39;gender&#39;</span><span class="p">:</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span>
<span class="gp">   ....: </span>    <span class="s1">&#39;experience_years&#39;</span><span class="p">:</span> <span class="mi">0</span>
<span class="gp">   ....: </span><span class="p">}</span>
<span class="gp">   ....: </span>

<span class="gp">In [58]: </span><span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">conditions</span><span class="o">=</span><span class="n">conditions</span><span class="p">)</span>
<span class="gh">Out[58]: </span><span class="go"></span>
<span class="go">   student_id gender  second_perc  high_perc high_spec  degree_perc degree_type  work_experience  experience_years  employability_perc mba_spec  mba_perc  salary  placed start_date end_date  duration</span>
<span class="go">0           0      M        44.32      43.04   Science        67.69    Sci&amp;Tech            False                 0               85.96   Mkt&amp;HR     54.77     NaN   False        NaT      NaT       NaN</span>
<span class="go">1           1      M        69.13      67.28  Commerce        67.50   Comm&amp;Mgmt            False                 0               62.64   Mkt&amp;HR     66.31     NaN   False        NaT      NaT       NaN</span>
<span class="go">2           2      M        65.57      63.27  Commerce        73.23   Comm&amp;Mgmt            False                 0               83.28   Mkt&amp;HR     53.25     NaN   False        NaT      NaT       NaN</span>
<span class="go">3           3      M        44.95      51.36   Science        52.32   Comm&amp;Mgmt            False                 0               63.09   Mkt&amp;HR     50.73     NaN   False        NaT      NaT       NaN</span>
<span class="go">4           4      M        85.30      69.62   Science        70.57    Sci&amp;Tech            False                 0               65.79  Mkt&amp;Fin     56.80     NaN   False        NaT      NaT       NaN</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">conditions</span></code> can also be passed as a dataframe. In that case, the model
will generate one sample for each row of the dataframe, sorted in the same
order. Since the model already knows how many samples to generate, passing
it as a parameter is unnecessary. For example, if we want to generate three
samples where <code class="docutils literal notranslate"><span class="pre">gender</span> <span class="pre">=</span> <span class="pre">M</span></code> and three samples with <code class="docutils literal notranslate"><span class="pre">gender</span> <span class="pre">=</span> <span class="pre">F</span></code>, we can do the
following:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [59]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [60]: </span><span class="n">conditions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">   ....: </span>    <span class="s1">&#39;gender&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">],</span>
<span class="gp">   ....: </span><span class="p">})</span>
<span class="gp">   ....: </span>

<span class="gp">In [61]: </span><span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">conditions</span><span class="o">=</span><span class="n">conditions</span><span class="p">)</span>
<span class="gh">Out[61]: </span><span class="go"></span>
<span class="go">   student_id gender  second_perc  high_perc high_spec  degree_perc degree_type  work_experience  experience_years  employability_perc mba_spec  mba_perc   salary  placed start_date   end_date  duration</span>
<span class="go">0           0      M        66.40      62.50  Commerce        62.13      Others            False                 0               79.46  Mkt&amp;Fin     64.27      NaN   False        NaT        NaT       NaN</span>
<span class="go">1           1      M        76.09      73.34  Commerce        71.38   Comm&amp;Mgmt            False                 0               76.29  Mkt&amp;Fin     60.11  24700.0    True 2020-02-06 2020-06-14       3.0</span>
<span class="go">2           2      M        72.26      69.11  Commerce        54.37   Comm&amp;Mgmt            False                 0               69.67   Mkt&amp;HR     56.43      NaN   False        NaT        NaT       NaN</span>
<span class="go">3           3      F        66.40      64.18  Commerce        71.74   Comm&amp;Mgmt            False                 0               80.48   Mkt&amp;HR     71.72      NaN   False        NaT        NaT       NaN</span>
<span class="go">4           4      F        77.39      75.82  Commerce        76.53   Comm&amp;Mgmt            False                 0               63.03   Mkt&amp;HR     56.53  23100.0    True 2020-01-25 2020-06-09       4.0</span>
<span class="go">5           5      F        63.89      66.84  Commerce        54.49   Comm&amp;Mgmt            False                 0               59.35   Mkt&amp;HR     53.50      NaN   False        NaT        NaT       NaN</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> also supports conditioning on continuous values, as long as the values
are within the range of seen numbers. For example, if all the values of the
dataset are within 0 and 1, <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> will not be able to set this value to 1000.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [62]: </span><span class="n">conditions</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">   ....: </span>    <span class="s1">&#39;degree_perc&#39;</span><span class="p">:</span> <span class="mf">70.0</span>
<span class="gp">   ....: </span><span class="p">}</span>
<span class="gp">   ....: </span>

<span class="gp">In [63]: </span><span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">conditions</span><span class="o">=</span><span class="n">conditions</span><span class="p">)</span>
<span class="gh">Out[63]: </span><span class="go"></span>
<span class="go">   student_id gender  second_perc  high_perc high_spec  degree_perc degree_type  work_experience  experience_years  employability_perc mba_spec  mba_perc   salary  placed start_date   end_date  duration</span>
<span class="go">0           0      F        74.87      66.91   Science         70.0    Sci&amp;Tech            False                 0               67.02   Mkt&amp;HR     57.20  20700.0    True 2020-07-31 2020-09-13       1.0</span>
<span class="go">1           1      M        70.53      71.28  Commerce         70.0    Sci&amp;Tech            False                 0               71.10   Mkt&amp;HR     64.87  24600.0    True 2020-02-07 2020-06-30       5.0</span>
<span class="go">2           2      M        81.05      69.48   Science         70.0   Comm&amp;Mgmt            False                 0               90.18  Mkt&amp;Fin     67.05      NaN   False        NaT        NaT       NaN</span>
<span class="go">3           3      F        58.56      73.27  Commerce         70.0   Comm&amp;Mgmt            False                 0               96.75  Mkt&amp;Fin     55.40  32300.0    True 2020-02-16 2020-07-14       3.0</span>
<span class="go">4           4      M        72.64      68.30   Science         70.0   Comm&amp;Mgmt            False                 1               97.79  Mkt&amp;Fin     62.57  40000.0    True 2020-09-02 2020-12-29       5.0</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently, conditional sampling works through a rejection sampling process,
where rows are sampled repeatedly until one that satisfies the conditions is
found. In case you are running into a <code class="docutils literal notranslate"><span class="pre">Could</span> <span class="pre">not</span> <span class="pre">get</span> <span class="pre">enough</span> <span class="pre">valid</span> <span class="pre">rows</span> <span class="pre">within</span>
<span class="pre">x</span> <span class="pre">trials</span></code> or simply wish to optimize the results, there are three parameters
that can be fine-tuned: <code class="docutils literal notranslate"><span class="pre">max_rows_multiplier</span></code>, <code class="docutils literal notranslate"><span class="pre">max_retries</span></code> and <code class="docutils literal notranslate"><span class="pre">float_rtol</span></code>.
More information about these parameters can be found in the <a class="reference external" href="https://sdv.dev/SDV/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.sample.html">API section</a>.</p>
</div>
</section>
<section id="how-do-i-specify-constraints">
<h3>How do I specify constraints?<a class="headerlink" href="#how-do-i-specify-constraints" title="Permalink to this headline">¶</a></h3>
<p>If you look closely at the data you may notice that some properties were
not completely captured by the model. For example, you may have seen
that sometimes the model produces an <code class="docutils literal notranslate"><span class="pre">experience_years</span></code> number greater
than <code class="docutils literal notranslate"><span class="pre">0</span></code> while also indicating that <code class="docutils literal notranslate"><span class="pre">work_experience</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>.
These types of properties are what we call <code class="docutils literal notranslate"><span class="pre">Constraints</span></code> and can also
be handled using <code class="docutils literal notranslate"><span class="pre">SDV</span></code>. For further details about them please visit
the <a class="reference internal" href="constraints.html#single-table-constraints"><span class="std std-ref">Constraints</span></a> guide.</p>
</section>
<section id="can-i-evaluate-the-synthetic-data">
<h3>Can I evaluate the Synthetic Data?<a class="headerlink" href="#can-i-evaluate-the-synthetic-data" title="Permalink to this headline">¶</a></h3>
<p>A very common question when someone starts using <strong>SDV</strong> to generate
synthetic data is: <em>“How good is the data that I just generated?”</em></p>
<p>In order to answer this question, <strong>SDV</strong> has a collection of metrics
and tools that allow you to compare the <em>real</em> that you provided and the
<em>synthetic</em> data that you generated using <strong>SDV</strong> or any other tool.</p>
<p>You can read more about this in the <a class="reference internal" href="../evaluation/index.html#evaluation"><span class="std std-ref">Synthetic Data Evaluation</span></a> guide.</p>
</section>
</section>
</section>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="models.html" title="previous page">Models</a>
    <a class='right-next' id="next-link" href="ctgan.html" title="next page">CTGAN Model</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-180602145-3', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2018, MIT Data To AI Lab.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.2.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>